import{s as $e}from"./D7x77NIs.js";import"./CWj6FrbW.js";import{d as ie,o as Ee,s as D}from"./BVW34SQx.js";import{k as se,p as re,$ as Be,s as g,d as I,g as a,e as k,f as Ce,h as c,i as l,r as n,t as $,a as h,a0 as Pe,b as ne,a1 as le}from"./CNfditUa.js";import{i as j}from"./GC4dxQQb.js";import{t as He,e as Ve,a as F,s as ze,i as Oe,g as V,c as Le}from"./BEFEBz6G.js";import{p as ce,b as q}from"./0rDqRz2G.js";function Ne(d,u,t,s){var v=d.__style;if(se||v!==u){var b=He(u);(!se||b!==d.getAttribute("style"))&&(b==null?d.removeAttribute("style"):d.style.cssText=b),d.__style=u}return s}const Ue=()=>{const d=$e;return{page:{subscribe:d.page.subscribe},navigating:{subscribe:d.navigating.subscribe},updated:d.updated}},ut={subscribe(d){return Ue().page.subscribe(d)}};function qe(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}var De=k('<audio preload="auto"><source type="audio/mpeg"/></audio>'),Ke=k('<div class="absolute inset-0 bg-black pointer-events-none" style="opacity: 0; z-index: 10;"></div>'),Re=(d,u,t,s)=>a(u)?t():s(),Ge=le('<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6"></path></svg>'),Je=le('<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg>'),Qe=(d,u,t,s)=>{a(u)&&(t(),s())},We=k('<div class="flex items-center space-x-2 text-white"><label for="speed" class="text-sm">Speed:</label> <select id="speed" class="bg-gray-700 text-white rounded px-2 py-1 text-sm"><option>Fast (2s)</option><option>Normal (3s)</option><option>Slow (5s)</option><option>Very Slow (10s)</option></select></div>'),Xe=k('<span class="text-yellow-400"> </span>'),Ye=k('<div class="flex items-center space-x-2 text-white text-sm"><span>Scavenger Hunt Mode</span> <!></div>'),Ze=k('<button><img class="w-full h-full object-cover"/></button>'),et=k('<div class="relative bg-black rounded-lg overflow-hidden"><!> <div class="relative aspect-video"><img class="w-full h-full object-contain"/> <!> <div class="absolute inset-0 flex items-center justify-between p-4 opacity-0 hover:opacity-100 transition-opacity"><button class="p-2 rounded-full bg-black bg-opacity-50 text-white hover:bg-opacity-75 transition-colors"><svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <button class="p-2 rounded-full bg-black bg-opacity-50 text-white hover:bg-opacity-75 transition-colors"><svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button></div> <div class="absolute top-4 right-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded-full text-sm"> </div></div> <div class="bg-gray-900 p-4"><div class="flex items-center justify-between mb-4"><div class="flex items-center space-x-4"><button class="p-2 rounded-full bg-gray-700 text-white hover:bg-gray-600 transition-colors"><!></button> <button class="p-2 rounded bg-gray-700 text-white hover:bg-gray-600 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.333 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z"></path></svg></button> <button class="p-2 rounded bg-gray-700 text-white hover:bg-gray-600 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.933 12.8a1 1 0 000-1.6L6.6 7.2A1 1 0 005 8v8a1 1 0 001.6.8l5.333-4zM19.933 12.8a1 1 0 000-1.6l-5.333-4A1 1 0 0013 8v8a1 1 0 001.6.8l5.333-4z"></path></svg></button></div> <!> <button class="p-2 rounded bg-gray-700 text-white hover:bg-gray-600 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg></button></div> <div class="flex space-x-2 overflow-x-auto pb-2"></div></div></div> <div class="mt-4 text-sm text-gray-500 text-center">Tip: Use arrow keys to navigate, spacebar to play/pause, and ESC to exit fullscreen</div>',1);function vt(d,u){re(u,!0);let t=ce(u,"project",7),s=I(0),v=I(!1),b,M=I(3e3),E,r,i,m=I(!1),_=I("fadeIn"),w,B=I(0);Be(()=>(g(m,t().type==="Scavenger-Hunt"),a(m)&&(console.log("SlideshowViewer project data:",t()),console.log("Audio file:",t().audioFile),console.log("Audio:",t().audio),t().images.length>12&&(t().images=t().images.slice(0,12))),()=>{b&&clearInterval(b),w&&clearTimeout(w)}));function S(){g(v,!0),a(m)?ue():b=setInterval(()=>{A()},a(M))}function T(){g(v,!1),b&&clearInterval(b),w&&clearTimeout(w),r&&r.pause()}function A(){(!a(m)||!a(v))&&g(s,(a(s)+1)%t().images.length)}function z(){(!a(m)||!a(v))&&g(s,a(s)===0?t().images.length-1:a(s)-1,!0)}function de(e){(!a(m)||!a(v))&&(g(s,e,!0),a(v)&&(T(),S()))}function ue(){g(s,0),g(_,"fadeIn"),r&&(t().audio||t().audioFile)&&(r.currentTime=0,r.volume=0,r.play().then(()=>{ge()}).catch(e=>{console.error("Audio playback failed:",e)})),ve()}function ve(){i&&(i.style.transition="none",i.style.opacity="1",i.offsetHeight,i.style.transition="opacity 1s ease-in-out",i.style.opacity="0",setTimeout(()=>{K()},1e3))}function K(){g(_,"hold"),w=setTimeout(()=>{a(s)<t().images.length-1?pe():fe()},5e3)}function pe(){g(_,"crossfade");const e=a(s)+1;i&&(i.style.transition="opacity 0.5s ease-in-out",i.style.opacity="1",setTimeout(()=>{g(s,e),setTimeout(()=>{i.style.opacity="0",setTimeout(()=>{K()},500)},50)},500))}function fe(){g(_,"fadeOut"),i&&(i.style.transition="none",i.style.opacity="0",i.offsetHeight,i.style.transition="opacity 1s ease-in-out",i.style.opacity="1"),r&&me(),setTimeout(()=>{g(v,!1)},1e3)}function ge(){if(r){const e=setInterval(()=>{r.volume<1?r.volume=Math.min(r.volume+.05,1):clearInterval(e)},50)}}function me(){if(r){const e=setInterval(()=>{r.volume>0?r.volume=Math.max(r.volume-.05,0):(clearInterval(e),r.pause())},50)}}function R(e){switch(e.key){case"ArrowLeft":z();break;case"ArrowRight":A();break;case" ":e.preventDefault(),a(v)?T():S();break;case"Escape":document.fullscreenElement&&document.exitFullscreen();break}}function G(e){const o=typeof e=="string"?e:e.name;return`${V()}/api/files/${t().id}/${o}`}function be(){if(a(m)&&t().audioFile){const e=typeof t().audioFile=="object"?t().audioFile.name:t().audioFile;return`${V()}/api/files/${t().id}/${e}`}return`${V()}/api/files/${t().id}/song.mp3`}function he(e){if(!e)return 0;const o=e.split(":").map(p=>parseInt(p,10));return o.length===2?o[0]*60+o[1]:o.length===3?o[0]*3600+o[1]*60+o[2]:0}Ee(()=>(document.addEventListener("keydown",R),t().audioOffset&&g(B,he(t().audioOffset)||0,!0),()=>{document.removeEventListener("keydown",R)}));var J=et(),Q=Ce(J),W=c(Q);{var _e=e=>{var o=De(),p=c(o);n(o),q(o,f=>r=f,()=>r),$(f=>F(p,"src",f),[be]),h(e,o)};j(W,e=>{a(m)&&(t().audio||t().audioFile)&&e(_e)})}var O=l(W,2),C=c(O);q(C,e=>E=e,()=>E);var X=l(C,2);{var ye=e=>{var o=Ke();q(o,p=>i=p,()=>i),h(e,o)};j(X,e=>{a(m)&&e(ye)})}var L=l(X,2),Y=c(L);Y.__click=z;var xe=l(Y,2);xe.__click=A,n(L);var Z=l(L,2),ke=c(Z);n(Z),n(O);var ee=l(O,2),N=c(ee),U=c(N),P=c(U);P.__click=[Re,v,T,S];var we=c(P);{var Se=e=>{var o=Ge();h(e,o)},Te=e=>{var o=Je();h(e,o)};j(we,e=>{a(v)?e(Se):e(Te,!1)})}n(P);var te=l(P,2);te.__click=z;var Ae=l(te,2);Ae.__click=A,n(U);var oe=l(U,2);{var Ie=e=>{var o=We(),p=l(c(o),2);p.__change=[Qe,v,T,S];var f=c(p);f.value=f.__value=2e3;var y=l(f);y.value=y.__value=3e3;var x=l(y);x.value=x.__value=5e3;var H=l(x);H.value=H.__value=1e4,n(p),n(o),Le(p,()=>a(M),Fe=>g(M,Fe)),h(e,o)},je=e=>{var o=Ye(),p=l(c(o),2);{var f=y=>{var x=Xe(),H=c(x);n(x),$(()=>D(H,`(${a(_)??""})`)),h(y,x)};j(p,y=>{a(_)!=="hold"&&y(f)})}n(o),h(e,o)};j(oe,e=>{a(m)?e(je,!1):e(Ie)})}var Me=l(oe,2);Me.__click=[qe],n(N);var ae=l(N,2);Ve(ae,21,()=>t().images,Oe,(e,o,p)=>{var f=Ze();f.__click=()=>de(p);var y=c(f);F(y,"alt",`Thumbnail ${p+1}`),n(f),$(x=>{ze(f,1,`flex-shrink-0 w-20 h-20 rounded overflow-hidden border-2 transition-colors ${p===a(s)?"border-indigo-500":"border-transparent"}`),F(y,"src",x)},[()=>G(a(o))]),h(e,f)}),n(ae),n(ee),n(Q),Pe(2),$(e=>{F(C,"src",e),F(C,"alt",`Slide ${a(s)+1}`),D(ke,`${a(s)+1} / ${t().images.length??""}`)},[()=>G(t().images[a(s)])]),h(d,J),ne()}ie(["click","change"]);async function tt(d,u){try{(await fetch(`${V()}/api/process/${u().id}/cancel`,{method:"POST"})).ok&&(u().status="cancelled")}catch(t){console.error("Failed to cancel processing:",t)}}var ot=k('<div class="mt-2"><div class="bg-gray-200 rounded-full h-2 w-32"><div class="bg-indigo-600 h-2 rounded-full transition-all duration-300"></div></div> <p class="text-xs text-gray-500 mt-1"> </p></div>'),at=k('<div class="flex items-center space-x-4"><div class="flex-1"><div class="flex items-center space-x-2"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600"></div> <span class="text-sm text-gray-600">Processing slideshow...</span></div> <!></div> <button class="px-3 py-1 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50">Cancel</button></div>');function pt(d,u){re(u,!0);let t=ce(u,"project",7);function s(){return t().progress?Math.round(t().progress*100):0}var v=at(),b=c(v),M=l(c(b),2);{var E=i=>{var m=ot(),_=c(m),w=c(_);n(_);var B=l(_,2),S=c(B);n(B),n(m),$((T,A)=>{Ne(w,`width: ${T??""}%`),D(S,`${A??""}% complete`)},[s,s]),h(i,m)};j(M,i=>{t().progress&&i(E)})}n(b);var r=l(b,2);r.__click=[tt,t],n(v),h(d,v),ne()}ie(["click"]);export{pt as P,vt as S,ut as p,Ne as s};
