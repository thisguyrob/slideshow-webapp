import{s as we}from"./DeFU6qEV.js";import"./CWj6FrbW.js";import{d as ee,c as ve,f as V,s as R,o as ke}from"./CZG4RayU.js";import{k as ce,aT as Se,I as je,J as Z,p as te,e as F,h as v,i as m,r as c,n as se,g as l,d as L,t as U,a as z,b as re,s as C,C as Ce,a2 as Me,f as $e,aU as ue}from"./CTg2jUt1.js";import{i as K}from"./dXEtNgE2.js";import{t as De,d as Ee,s as pe,e as fe,r as Ie,a as H,f as Pe,i as Ae,c as Te}from"./BthX63rt.js";import{b as ge,p as he}from"./5EVyXMsi.js";function me(t,e,r,s){var o=t.__style;if(ce||o!==e){var i=De(e);(!ce||i!==t.getAttribute("style"))&&(i==null?t.removeAttribute("style"):t.style.cssText=i),t.__style=e}return s}const ze=()=>performance.now(),B={tick:t=>requestAnimationFrame(t),now:()=>ze(),tasks:new Set};function be(){const t=B.now();B.tasks.forEach(e=>{e.c(t)||(B.tasks.delete(e),e.f())}),B.tasks.size!==0&&B.tick(be)}function Fe(t){let e;return B.tasks.size===0&&B.tick(be),{promise:new Promise(r=>{B.tasks.add(e={c:t,f:r})}),abort(){B.tasks.delete(e)}}}function Be(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function de(t){const e={},r=t.split(";");for(const s of r){const[o,i]=s.split(":");if(!o||i===void 0)break;const u=Be(o.trim());e[u]=i.trim()}return e}const Le=t=>t;function Ue(t,e,r){var s=Ee,o,i,u,_=null;s.a??(s.a={element:t,measure(){o=this.element.getBoundingClientRect()},apply(){if(u==null||u.abort(),i=this.element.getBoundingClientRect(),o.left!==i.left||o.right!==i.right||o.top!==i.top||o.bottom!==i.bottom){const f=e()(this.element,{from:o,to:i},r==null?void 0:r());u=xe(this.element,f,void 0,1,()=>{u==null||u.abort(),u=void 0})}},fix(){if(!t.getAnimations().length){var{position:f,width:h,height:k}=getComputedStyle(t);if(f!=="absolute"&&f!=="fixed"){var d=t.style;_={position:d.position,width:d.width,height:d.height,transform:d.transform},d.position="absolute",d.width=h,d.height=k;var M=t.getBoundingClientRect();if(o.left!==M.left||o.top!==M.top){var y=`translate(${o.left-M.left}px, ${o.top-M.top}px)`;d.transform=d.transform?`${d.transform} ${y}`:y}}}},unfix(){if(_){var f=t.style;f.position=_.position,f.width=_.width,f.height=_.height,f.transform=_.transform}}}),s.a.element=t}function xe(t,e,r,s,o){if(Se(e)){var i,u=!1;return je(()=>{if(!u){var S=e({direction:"in"});i=xe(t,S,r,s,o)}}),{abort:()=>{u=!0,i==null||i.abort()},deactivate:()=>i.deactivate(),reset:()=>i.reset(),t:()=>i.t()}}if(!(e!=null&&e.duration))return o(),{abort:Z,deactivate:Z,reset:Z,t:()=>s};const{delay:_=0,css:f,tick:h,easing:k=Le}=e;var d=[];if(h&&h(0,1),f){var M=de(f(0,1));d.push(M,M)}var y=()=>1-s,x=t.animate(d,{duration:_,fill:"forwards"});return x.onfinish=()=>{x.cancel();var S=1-s,I=s-S,A=e.duration*Math.abs(I),b=[];if(A>0){var j=!1;if(f)for(var D=Math.ceil(A/16.666666666666668),g=0;g<=D;g+=1){var n=S+I*k(g/D),a=de(f(n,1-n));b.push(a),j||(j=a.overflow==="hidden")}j&&(t.style.overflow="hidden"),y=()=>{var p=x.currentTime;return S+I*k(p/A)},h&&Fe(()=>{if(x.playState!=="running")return!1;var p=y();return h(p,1-p),!0})}x=t.animate(b,{duration:A,fill:"forwards"}),x.onfinish=()=>{y=()=>s,h==null||h(s,1-s),o()}},{abort:()=>{x&&(x.cancel(),x.effect=null,x.onfinish=Z)},deactivate:()=>{o=Z},reset:()=>{},t:()=>y()}}const Oe=()=>{const t=we;return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},updated:t.updated}},bt={subscribe(t){return Oe().page.subscribe(t)}};function Ne(t,e){const r=t.target,s=Array.from(r.files||[]);e(s)}var qe=F('<div class="mt-4"><div class="bg-gray-200 rounded-full h-2 w-48 mx-auto"><div class="bg-indigo-600 h-2 rounded-full transition-all duration-300"></div></div> <p class="text-sm text-gray-600 mt-2"> </p></div>'),He=F('<div><div class="space-y-1 text-center"><svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> <div class="flex text-sm text-gray-600"><label for="file-upload" class="relative cursor-pointer rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"><span>Upload files</span> <input id="file-upload" name="file-upload" type="file" class="sr-only" multiple accept="image/*,.heic"/></label> <p class="pl-1">or drag and drop</p></div> <p class="text-xs text-gray-500">PNG, JPG, GIF, HEIC up to 100MB each</p> <!></div></div>');function xt(t,e){te(e,!0);const r=ve();let s=L(!1),o=L(!1),i=L(0),u;function _(b){b.preventDefault(),C(s,!0)}function f(){C(s,!1)}function h(b){var D;b.preventDefault(),C(s,!1);const j=Array.from(((D=b.dataTransfer)==null?void 0:D.files)||[]);k(j)}async function k(b){const j=b.filter(g=>g.type.startsWith("image/")||g.name.toLowerCase().endsWith(".heic"));if(j.length===0){alert("Please select image files only");return}C(o,!0),C(i,0);const D=new FormData;j.forEach(g=>{D.append("images",g)});try{const g=new XMLHttpRequest;g.upload.addEventListener("progress",n=>{n.lengthComputable&&C(i,n.loaded/n.total*100)}),g.addEventListener("load",()=>{g.status===200?(r("uploaded"),u.value=""):alert("Upload failed. Please try again."),C(o,!1)}),g.addEventListener("error",()=>{alert("Upload failed. Please try again."),C(o,!1)}),g.open("POST",`http://localhost:3000/api/upload/${e.projectId}/images`),g.send(D)}catch(g){console.error("Upload error:",g),alert("Upload failed. Please try again."),C(o,!1)}}var d=He(),M=v(d),y=m(v(M),2),x=v(y),S=m(v(x),2);S.__change=[Ne,k],ge(S,b=>u=b,()=>u),c(x),se(2),c(y);var I=m(y,4);{var A=b=>{var j=qe(),D=v(j),g=v(D);c(D);var n=m(D,2),a=v(n);c(n),c(j),U(p=>{me(g,`width: ${l(i)??""}%`),R(a,`Uploading... ${p??""}%`)},[()=>Math.round(l(i))]),z(b,j)};K(I,b=>{l(o)&&b(A)})}c(M),c(d),U(()=>{pe(d,1,`mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-lg transition-colors ${l(s)?"border-indigo-400 bg-indigo-50":"border-gray-300"}`),S.disabled=l(o)}),V("dragover",d,_),V("dragleave",d,f),V("drop",d,h),z(t,d),re()}ee(["change"]);function Ve(t){const e=t-1;return e*e*e+1}function Re(t){return--t*t*t*t*t+1}function We(t,{from:e,to:r},s={}){var{delay:o=0,duration:i=n=>Math.sqrt(n)*120,easing:u=Ve}=s,_=getComputedStyle(t),f=_.transform==="none"?"":_.transform,[h,k]=_.transformOrigin.split(" ").map(parseFloat);h/=t.clientWidth,k/=t.clientHeight;var d=Ge(t),M=t.clientWidth/r.width/d,y=t.clientHeight/r.height/d,x=e.left+e.width*h,S=e.top+e.height*k,I=r.left+r.width*h,A=r.top+r.height*k,b=(x-I)*M,j=(S-A)*y,D=e.width/r.width,g=e.height/r.height;return{delay:o,duration:typeof i=="function"?i(Math.sqrt(b*b+j*j)):i,easing:u,css:(n,a)=>{var p=a*b,P=a*j,T=n+a*D,$=n+a*g;return`transform: ${f} translate(${p}px, ${P}px) scale(${T}, ${$});`}}}function Ge(t){if("currentCSSZoom"in t)return t.currentCSSZoom;for(var e=t,r=1;e!==null;)r*=+getComputedStyle(e).zoom,e=e.parentElement;return r}async function Je(t,e,r,s){if(l(e).size===0||!confirm(`Delete ${l(e).size} selected images?`))return;const o=Array.from(l(e)).map(i=>fetch(`http://localhost:3000/api/upload/${r().id}/files/${i}`,{method:"DELETE"}));try{await Promise.all(o),l(e).clear(),s("updated")}catch(i){console.error("Failed to delete images:",i)}}var Ze=F('<button class="inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700"> </button>'),Ke=(t,e)=>e("add-more"),Xe=(t,e,r)=>e(r),Qe=F('<div class="absolute inset-0 bg-indigo-600 bg-opacity-20 rounded-lg"></div>'),Ye=F('<div draggable="true" class="relative group cursor-move"><div class="aspect-square overflow-hidden rounded-lg bg-gray-100"><img class="w-full h-full object-cover group-hover:opacity-75 transition-opacity"/></div> <div class="absolute top-2 left-2"><input type="checkbox" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"/></div> <!> <div class="absolute bottom-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded"> </div></div>'),et=F('<div class="space-y-4"><div class="flex justify-between items-center"><div class="flex items-center space-x-4"><span class="text-sm text-gray-500"> </span> <!></div> <button class="inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"><svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add More</button></div> <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"></div> <p class="text-sm text-gray-500 text-center">Drag and drop images to reorder them</p></div>');function _t(t,e){te(e,!0);let r=he(e,"project",7);const s=ve();let o=L(Ce(new Set)),i=L(!1),u=L(null);function _(n){const a=typeof n=="string"?n:n.name;l(o).has(a)?l(o).delete(a):l(o).add(a),C(o,new Set(l(o)),!0)}function f(n,a){const p=typeof a=="string"?a:a.name;C(u,p,!0),n.dataTransfer&&(n.dataTransfer.effectAllowed="move")}function h(n){n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move")}function k(n,a){n.preventDefault();const p=typeof a=="string"?a:a.name;if(!l(u)||l(u)===p)return;const P=r().images.findIndex($=>(typeof $=="string"?$:$.name)===l(u)),T=r().images.findIndex($=>(typeof $=="string"?$:$.name)===p);if(P!==-1&&T!==-1){const $=[...r().images],O=$.splice(P,1)[0];$.splice(T,0,O),d($)}C(u,null)}async function d(n){C(i,!0);try{const a=n.map(P=>typeof P=="string"?P:P.name);(await fetch(`http://localhost:3000/api/projects/${r().id}/reorder`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({images:a})})).ok&&(r().images=n)}catch(a){console.error("Failed to save new order:",a)}finally{C(i,!1)}}function M(n){const a=typeof n=="string"?n:n.name;return`http://localhost:3000/api/files/${r().id}/${a}`}var y=et(),x=v(y),S=v(x),I=v(S),A=v(I);c(I);var b=m(I,2);{var j=n=>{var a=Ze();a.__click=[Je,o,r,s];var p=v(a);c(a),U(()=>R(p,`Delete ${l(o).size??""} selected`)),z(n,a)};K(b,n=>{l(o).size>0&&n(j)})}c(S);var D=m(S,2);D.__click=[Ke,s],c(x);var g=m(x,2);fe(g,28,()=>r().images,n=>n,(n,a)=>{var p=Ye(),P=v(p),T=v(P);c(P);var $=m(P,2),O=v($);Ie(O),O.__change=[Xe,_,a],c($);var X=m($,2);{var Q=E=>{var N=Qe();z(E,N)};K(X,E=>{l(i)&&l(u)===(typeof a=="string"?a:a.name)&&E(Q)})}var Y=m(X,2),W=v(Y,!0);c(Y),c(p),U((E,N,G)=>{H(T,"src",E),H(T,"alt",typeof a=="string"?a:a.name),Pe(O,N),R(W,G)},[()=>M(a),()=>l(o).has(typeof a=="string"?a:a.name),()=>r().images.findIndex(E=>(typeof E=="string"?E:E.name)===(typeof a=="string"?a:a.name))+1]),V("dragstart",p,E=>f(E,a)),V("dragover",p,h),V("drop",p,E=>k(E,a)),Ue(p,()=>We,()=>({duration:300,easing:Re})),z(n,p)}),c(g),se(2),c(y),U(()=>R(A,`${r().images.length??""} images`)),z(t,y),re()}ee(["click","change"]);function tt(){document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}var rt=(t,e,r,s)=>l(e)?r():s(),at=ue('<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6"></path></svg>'),ot=ue('<svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg>'),st=(t,e,r,s)=>{l(e)&&(r(),s())},it=F('<button><img class="w-full h-full object-cover"/></button>'),nt=F('<div class="relative bg-black rounded-lg overflow-hidden"><div class="relative aspect-video"><img class="w-full h-full object-contain"/> <div class="absolute inset-0 flex items-center justify-between p-4 opacity-0 hover:opacity-100 transition-opacity"><button class="p-2 rounded-full bg-black bg-opacity-50 text-white hover:bg-opacity-75 transition-colors"><svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <button class="p-2 rounded-full bg-black bg-opacity-50 text-white hover:bg-opacity-75 transition-colors"><svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button></div> <div class="absolute top-4 right-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded-full text-sm"> </div></div> <div class="bg-gray-900 p-4"><div class="flex items-center justify-between mb-4"><div class="flex items-center space-x-4"><button class="p-2 rounded-full bg-gray-700 text-white hover:bg-gray-600 transition-colors"><!></button> <button class="p-2 rounded bg-gray-700 text-white hover:bg-gray-600 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.333 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z"></path></svg></button> <button class="p-2 rounded bg-gray-700 text-white hover:bg-gray-600 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.933 12.8a1 1 0 000-1.6L6.6 7.2A1 1 0 005 8v8a1 1 0 001.6.8l5.333-4zM19.933 12.8a1 1 0 000-1.6l-5.333-4A1 1 0 0013 8v8a1 1 0 001.6.8l5.333-4z"></path></svg></button></div> <div class="flex items-center space-x-2 text-white"><label for="speed" class="text-sm">Speed:</label> <select id="speed" class="bg-gray-700 text-white rounded px-2 py-1 text-sm"><option>Fast (2s)</option><option>Normal (3s)</option><option>Slow (5s)</option><option>Very Slow (10s)</option></select></div> <button class="p-2 rounded bg-gray-700 text-white hover:bg-gray-600 transition-colors"><svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg></button></div> <div class="flex space-x-2 overflow-x-auto pb-2"></div></div></div> <div class="mt-4 text-sm text-gray-500 text-center">Tip: Use arrow keys to navigate, spacebar to play/pause, and ESC to exit fullscreen</div>',1);function yt(t,e){te(e,!0);let r=L(0),s=L(!1),o,i=L(3e3),u;Me(()=>()=>{o&&clearInterval(o)});function _(){C(s,!0),o=setInterval(()=>{h()},l(i))}function f(){C(s,!1),o&&clearInterval(o)}function h(){C(r,(l(r)+1)%e.project.images.length)}function k(){C(r,l(r)===0?e.project.images.length-1:l(r)-1,!0)}function d(w){C(r,w,!0),l(s)&&(f(),_())}function M(w){switch(w.key){case"ArrowLeft":k();break;case"ArrowRight":h();break;case" ":w.preventDefault(),l(s)?f():_();break;case"Escape":document.fullscreenElement&&document.exitFullscreen();break}}function y(w){const q=typeof w=="string"?w:w.name;return`http://localhost:3000/api/files/${e.project.id}/${q}`}ke(()=>(document.addEventListener("keydown",M),()=>{document.removeEventListener("keydown",M)}));var x=nt(),S=$e(x),I=v(S),A=v(I);ge(A,w=>u=w,()=>u);var b=m(A,2),j=v(b);j.__click=k;var D=m(j,2);D.__click=h,c(b);var g=m(b,2),n=v(g);c(g),c(I);var a=m(I,2),p=v(a),P=v(p),T=v(P);T.__click=[rt,s,f,_];var $=v(T);{var O=w=>{var q=at();z(w,q)},X=w=>{var q=ot();z(w,q)};K($,w=>{l(s)?w(O):w(X,!1)})}c(T);var Q=m(T,2);Q.__click=k;var Y=m(Q,2);Y.__click=h,c(P);var W=m(P,2),E=m(v(W),2);E.__change=[st,s,f,_];var N=v(E);N.value=N.__value=2e3;var G=m(N);G.value=G.__value=3e3;var ae=m(G);ae.value=ae.__value=5e3;var ie=m(ae);ie.value=ie.__value=1e4,c(E),c(W);var _e=m(W,2);_e.__click=[tt],c(p);var ne=m(p,2);fe(ne,21,()=>e.project.images,Ae,(w,q,oe)=>{var J=it();J.__click=()=>d(oe);var le=v(J);H(le,"alt",`Thumbnail ${oe+1}`),c(J),U(ye=>{pe(J,1,`flex-shrink-0 w-20 h-20 rounded overflow-hidden border-2 transition-colors ${oe===l(r)?"border-indigo-500":"border-transparent"}`),H(le,"src",ye)},[()=>y(l(q))]),z(w,J)}),c(ne),c(a),c(S),se(2),U(w=>{H(A,"src",w),H(A,"alt",`Slide ${l(r)+1}`),R(n,`${l(r)+1} / ${e.project.images.length??""}`)},[()=>y(e.project.images[l(r)])]),Te(E,()=>l(i),w=>C(i,w)),z(t,x),re()}ee(["click","change"]);async function lt(t,e){try{(await fetch(`http://localhost:3000/api/process/${e().id}/cancel`,{method:"POST"})).ok&&(e().status="cancelled")}catch(r){console.error("Failed to cancel processing:",r)}}var ct=F('<div class="mt-2"><div class="bg-gray-200 rounded-full h-2 w-32"><div class="bg-indigo-600 h-2 rounded-full transition-all duration-300"></div></div> <p class="text-xs text-gray-500 mt-1"> </p></div>'),dt=F('<div class="flex items-center space-x-4"><div class="flex-1"><div class="flex items-center space-x-2"><div class="animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600"></div> <span class="text-sm text-gray-600">Processing slideshow...</span></div> <!></div> <button class="px-3 py-1 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50">Cancel</button></div>');function wt(t,e){te(e,!0);let r=he(e,"project",7);function s(){return r().progress?Math.round(r().progress*100):0}var o=dt(),i=v(o),u=m(v(i),2);{var _=h=>{var k=ct(),d=v(k),M=v(d);c(d);var y=m(d,2),x=v(y);c(y),c(k),U((S,I)=>{me(M,`width: ${S??""}%`),R(x,`${I??""}% complete`)},[s,s]),z(h,k)};K(u,h=>{r().progress&&h(_)})}c(i);var f=m(i,2);f.__click=[lt,r],c(o),z(t,o),re()}ee(["click"]);export{xt as I,wt as P,yt as S,_t as a,bt as p};
