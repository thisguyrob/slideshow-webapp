import"./CWj6FrbW.js";import{d as K,c as Q,s as Y}from"./CZG4RayU.js";import{p as X,e as D,h as o,r,a as j,b as Z,f as L,i,t as A,s as d,d as M,g as t,n as O}from"./CTg2jUt1.js";import{i as R}from"./dXEtNgE2.js";import{a as $,s as z,r as E,b as V}from"./BthX63rt.js";import{b as ee}from"./5EVyXMsi.js";async function te(U,e,p,a,m,x){if(!t(e).trim()){alert("Please enter a YouTube URL");return}d(p,!0);try{if((await fetch(`http://localhost:3000/api/upload/${a.projectId}/youtube`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t(e)})})).ok){const _=await fetch(`http://localhost:3000/api/upload/${a.projectId}/youtube-download`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t(e),startTime:t(m)||"0:00"})});if(_.ok)x("uploaded"),d(e,""),d(m,"0:00");else{const F=await _.json();alert(`Download failed: ${F.error||"Unknown error"}`)}}else alert("Invalid YouTube URL. Please try again.")}catch(y){console.error("YouTube error:",y),alert("Failed to process YouTube URL. Please try again.")}finally{d(p,!1)}}async function ae(U,e,p){if(confirm("Delete the audio file?"))try{(await fetch(`http://localhost:3000/api/upload/${e.projectId}/files/${e.audioFile}`,{method:"DELETE"})).ok&&p("uploaded")}catch(a){console.error("Failed to delete audio:",a)}}var oe=D('<div class="flex items-center justify-between"><div class="flex items-center space-x-4"><svg class="h-10 w-10 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path></svg> <div><p class="text-sm font-medium text-gray-900">Audio uploaded</p> <p class="text-sm text-gray-500"> </p></div></div> <button class="text-sm font-medium text-red-600 hover:text-red-500">Remove</button></div> <audio controls class="w-full mt-4"><source/></audio>',1),re=(U,e)=>d(e,"file"),ie=(U,e)=>d(e,"youtube"),se=D('<div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed border-gray-300 rounded-lg"><div class="space-y-1 text-center"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"></path></svg> <div class="flex text-sm text-gray-600"><label for="audio-upload" class="relative cursor-pointer rounded-md font-medium text-indigo-600 hover:text-indigo-500"><span>Upload audio file</span> <input id="audio-upload" type="file" class="sr-only" accept="audio/*,.mp3,.wav,.m4a,.aac"/></label></div> <p class="text-xs text-gray-500">MP3, WAV, M4A, or AAC</p></div></div>'),le=D('<div class="text-sm text-gray-600 bg-gray-50 p-3 rounded-md"><p class="font-medium mb-1">Processing steps:</p> <ul class="list-disc list-inside space-y-1 text-xs"><li>Downloading audio with yt-dlp</li> <li>Converting audio to MP3 with ffmpeg</li> <li>Detecting downbeats with madmom</li></ul> <p class="text-xs text-gray-500 mt-2">Check Docker terminal for detailed logs</p></div>'),de=D('<div class="space-y-4"><div><label for="youtube-url" class="block text-sm font-medium text-gray-700 mb-2">YouTube URL</label> <input id="youtube-url" type="text" placeholder="https://www.youtube.com/watch?v=..." class="block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"/></div> <div><label for="start-time" class="block text-sm font-medium text-gray-700 mb-2">Start Time (optional)</label> <input id="start-time" type="text" placeholder="0:00 (mm:ss or hh:mm:ss)" class="block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"/> <p class="text-xs text-gray-500 mt-1">Specify where to start extracting audio (default: 0:00)</p></div> <button class="w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"> </button> <!></div>'),ne=D('<div class="flex space-x-4 mb-4"><button>Upload File</button> <button>YouTube URL</button></div> <!>',1),ce=D('<div class="bg-white rounded-lg border border-gray-200 p-6"><!></div>');function be(U,e){X(e,!0);const p=Q();let a=M(!1),m=M("file"),x=M(""),y=M("0:00"),_;async function F(v){var f;const s=(f=v.target.files)==null?void 0:f[0];if(!s)return;if(!s.type.startsWith("audio/")&&!s.name.match(/\.(mp3|wav|m4a|aac)$/i)){alert("Please select an audio file");return}d(a,!0);const l=new FormData;l.append("audio",s);try{(await fetch(`http://localhost:3000/api/upload/${e.projectId}/audio`,{method:"POST",body:l})).ok?p("uploaded"):alert("Upload failed. Please try again.")}catch(g){console.error("Upload error:",g),alert("Upload failed. Please try again.")}finally{d(a,!1),_.value=""}}var S=ce(),B=o(S);{var J=v=>{var w=oe(),s=L(w),l=o(s),f=i(o(l),2),g=i(o(f),2),C=o(g,!0);r(g),r(f),r(l);var I=i(l,2);I.__click=[ae,e,p],r(s);var n=i(s,2),c=o(n);r(n),A(()=>{Y(C,e.audioFile),$(c,"src",`http://localhost:3000/api/files/${e.projectId??""}/${e.audioFile??""}`)}),j(v,w)},N=v=>{var w=ne(),s=L(w),l=o(s);l.__click=[re,m];var f=i(l,2);f.__click=[ie,m],r(s);var g=i(s,2);{var C=n=>{var c=se(),k=o(c),T=i(o(k),2),P=o(T),b=i(o(P),2);b.__change=F,ee(b,h=>_=h,()=>_),r(P),r(T),O(2),r(k),r(c),A(()=>b.disabled=t(a)),j(n,c)},I=n=>{var c=de(),k=o(c),T=i(o(k),2);E(T),r(k);var P=i(k,2),b=i(o(P),2);E(b),O(2),r(P);var h=i(P,2);h.__click=[te,x,a,e,y,p];var W=o(h,!0);r(h);var q=i(h,2);{var G=u=>{var H=le();j(u,H)};R(q,u=>{t(a)&&u(G)})}r(c),A(u=>{T.disabled=t(a),b.disabled=t(a),h.disabled=u,Y(W,t(a)?"Processing (yt-dlp + ffmpeg + madmom)...":"Download & Process Audio")},[()=>t(a)||!t(x).trim()]),V(T,()=>t(x),u=>d(x,u)),V(b,()=>t(y),u=>d(y,u)),j(n,c)};R(g,n=>{t(m)==="file"?n(C):n(I,!1)})}A(()=>{z(l,1,`flex-1 py-2 px-4 border rounded-md text-sm font-medium ${t(m)==="file"?"border-indigo-500 text-indigo-600 bg-indigo-50":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50"}`),z(f,1,`flex-1 py-2 px-4 border rounded-md text-sm font-medium ${t(m)==="youtube"?"border-indigo-500 text-indigo-600 bg-indigo-50":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50"}`)}),j(v,w)};R(B,v=>{e.hasAudio&&e.audioFile?v(J):v(N,!1)})}r(S),j(U,S),Z()}K(["click","change"]);export{be as A};
