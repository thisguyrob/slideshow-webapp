import"../chunks/CWj6FrbW.js";import{d as be,o as _e,s as V}from"../chunks/BVW34SQx.js";import{p as we,c as Y,f as Z,a as m,b as ye,s as j,g as t,d as D,e as _,h as o,i as v,r as s,t as H,u as ke}from"../chunks/CNfditUa.js";import{i as p}from"../chunks/GC4dxQQb.js";import{g as z,s as L,a as je}from"../chunks/BEFEBz6G.js";import{s as Ie,a as Pe}from"../chunks/0rDqRz2G.js";import{p as Se,P as Te,S as Fe}from"../chunks/Cty7KhZ4.js";import{g as ee}from"../chunks/D7x77NIs.js";import{A as $e,I as Ae,a as Me}from"../chunks/CN7Dxjc9.js";var We=_('<div class="min-h-screen bg-gray-50 flex justify-center items-center"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div></div>'),Ue=_('<a class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"><svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> Download Video</a>'),Ce=(T,u)=>u("normal"),Be=_('<button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700"><svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </button>'),Ve=_('<div class="flex items-center space-x-3"><!></div>'),De=(T,u)=>j(u,"images"),He=(T,u)=>j(u,"slideshow"),ze=_('<div class="space-y-8"><div><h2 class="text-lg font-medium text-gray-900 mb-4">Images</h2> <!></div> <div><h2 class="text-lg font-medium text-gray-900 mb-4">Audio</h2> <!></div></div>'),Le=_('<div class="text-center py-12"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No images uploaded</h3> <p class="mt-1 text-sm text-gray-500">Upload some images to preview the slideshow.</p></div>'),Ne=_('<div class="min-h-screen bg-gray-50"><header class="bg-white shadow-sm border-b"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center h-16"><div class="flex items-center"><a href="/" class="text-gray-500 hover:text-gray-700 mr-4" aria-label="Back to home"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></a> <div class="flex items-center gap-3"><h1 class="text-2xl font-bold text-gray-900"> </h1> <span> </span></div></div> <!></div></div></header> <div class="bg-white border-b"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><nav class="-mb-px flex space-x-8" aria-label="Tabs"><button>Images & Audio</button> <button>Preview Slideshow</button></nav></div></div> <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!></main></div>');function Ye(T,u){we(u,!0);const[te,ae]=Pe(),re=()=>Ie(Se,"$page",te);let a=D(null),N=D(!0),w=D("images");const g=re().params.id;function oe(e){if(!e.video||!e.lastProcessed)return!1;if(e.updatedAt&&e.lastProcessed){const n=new Date(e.updatedAt).getTime();return new Date(e.lastProcessed).getTime()>=n}return!0}async function I(){try{const e=await fetch(`${z()}/api/projects/${g}`);e.ok?j(a,await e.json(),!0):(console.error("Project not found:",g),alert("Project not found. Redirecting to home page."),ee("/"))}catch(e){console.error("Failed to load project:",e),alert("Failed to load project. Redirecting to home page."),ee("/")}finally{j(N,!1)}}function se(e){switch(e){case"FWI-main":return"FWI Main";case"FWI-emotional":return"FWI Emotional";case"Scavenger-Hunt":return"Scavenger Hunt";default:return"FWI Main"}}function ie(e){switch(e){case"FWI-main":return"bg-blue-100 text-blue-800";case"FWI-emotional":return"bg-purple-100 text-purple-800";case"Scavenger-Hunt":return"bg-green-100 text-green-800";default:return"bg-blue-100 text-blue-800"}}_e(()=>{I();const e=window.location.hostname,n=new WebSocket(`ws://${e}:3000`);return n.onmessage=P=>{const h=JSON.parse(P.data);h.projectId===g&&(j(a,{...t(a),...h},!0),h.status==="completed"&&I())},()=>{n.close()}});function O(){I()}function ne(){I()}async function de(e="normal"){try{const n=await fetch(`${z()}/api/process/${g}/process`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:e})});if(n.ok){const P=await n.json();j(a,{...t(a),status:"processing"},!0)}}catch(n){console.error("Failed to start processing:",n)}}var R=Y(),le=Z(R);{var ce=e=>{var n=We();m(e,n)},ve=(e,n)=>{{var P=h=>{var F=Ne(),$=o(F),G=o($),J=o(G),A=o(J),E=v(o(A),2),M=o(E),me=o(M,!0);s(M);var W=v(M,2),pe=o(W,!0);s(W),s(E),s(A);var ue=v(A,2);{var ge=d=>{var i=Ve(),f=o(i);{var x=l=>{Te(l,{get project(){return t(a)}})},y=(l,k)=>{{var S=r=>{var b=Ue();H(B=>je(b,"href",`${B??""}/api/process/${g??""}/download`),[z]),m(r,b)},c=r=>{var b=Be();b.__click=[Ce,de];var B=v(o(b));s(b),H(()=>V(B,` ${t(a).video?"Re-render Slideshow":"Generate Slideshow"}`)),m(r,b)};p(l,r=>{oe(t(a))?r(S):r(c,!1)},k)}};p(f,l=>{t(a).status==="processing"?l(x):l(y,!1)})}s(i),m(d,i)};p(ue,d=>{var i;((i=t(a).images)==null?void 0:i.length)>0&&t(a).audio&&d(ge)})}s(J),s(G),s($);var U=v($,2),q=o(U),K=o(q),C=o(K);C.__click=[De,w];var Q=v(C,2);Q.__click=[He,w],s(K),s(q),s(U);var X=v(U,2),he=o(X);{var fe=d=>{var i=ze(),f=o(i),x=v(o(f),2);{var y=r=>{Ae(r,{get projectId(){return g},$$events:{uploaded:O}})},l=r=>{Me(r,{get project(){return t(a)},$$events:{updated:I,"add-more":O}})};p(x,r=>{!t(a).images||t(a).images.length===0?r(y):r(l,!1)})}s(f);var k=v(f,2),S=v(o(k),2);const c=ke(()=>!!t(a).audio);$e(S,{get projectId(){return g},get hasAudio(){return t(c)},get audioFile(){return t(a).audio},$$events:{uploaded:ne}}),s(k),s(i),m(d,i)},xe=(d,i)=>{{var f=x=>{var y=Y(),l=Z(y);{var k=c=>{Fe(c,{get project(){return t(a)}})},S=c=>{var r=Le();m(c,r)};p(l,c=>{var r;((r=t(a).images)==null?void 0:r.length)>0?c(k):c(S,!1)})}m(x,y)};p(d,x=>{t(w)==="slideshow"&&x(f)},i)}};p(he,d=>{t(w)==="images"?d(fe):d(xe,!1)})}s(X),s(F),H((d,i)=>{V(me,t(a).name),L(W,1,`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${d??""}`),V(pe,i),L(C,1,`py-4 px-1 border-b-2 font-medium text-sm ${t(w)==="images"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),L(Q,1,`py-4 px-1 border-b-2 font-medium text-sm ${t(w)==="slideshow"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`)},[()=>ie(t(a).type),()=>se(t(a).type)]),m(h,F)};p(e,h=>{t(a)&&h(P)},n)}};p(le,e=>{t(N)?e(ce):e(ve,!1)})}m(T,R),ye(),ae()}be(["click"]);export{Ye as component};
