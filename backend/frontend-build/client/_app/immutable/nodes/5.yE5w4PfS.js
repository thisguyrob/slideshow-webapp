import"../chunks/CWj6FrbW.js";import{d as _e,o as we,s as V}from"../chunks/gcnQ8rQN.js";import{p as ye,c as Y,f as Z,a as p,b as ke,s as j,g as e,d as D,e as _,h as o,i as v,r as s,t as H,u as ee}from"../chunks/D902iWF1.js";import{i as m}from"../chunks/ZYqiJWqh.js";import{g as z,s as L,a as je}from"../chunks/BESee3hx.js";import{s as Ie,a as Pe}from"../chunks/BuPMYCAJ.js";import{p as Se,P as Te,S as Fe}from"../chunks/Bf8xj146.js";import{g as te}from"../chunks/BEMLZ1wU.js";import{A as $e,I as Ae,a as Me}from"../chunks/BLaP2sIo.js";var We=_('<div class="min-h-screen bg-gray-50 flex justify-center items-center"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div></div>'),Ue=_('<a class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"><svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> Download Video</a>'),Ce=(S,u)=>u("normal"),Be=_('<button class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700"><svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </button>'),Ve=_('<div class="flex items-center space-x-3"><!></div>'),De=(S,u)=>j(u,"images"),He=(S,u)=>j(u,"slideshow"),ze=_('<div class="space-y-8"><div><h2 class="text-lg font-medium text-gray-900 mb-4">Images</h2> <!></div> <div><h2 class="text-lg font-medium text-gray-900 mb-4">Audio</h2> <!></div></div>'),Le=_('<div class="text-center py-12"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No images uploaded</h3> <p class="mt-1 text-sm text-gray-500">Upload some images to preview the slideshow.</p></div>'),Ne=_('<div class="min-h-screen bg-gray-50"><header class="bg-white shadow-sm border-b"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center h-16"><div class="flex items-center"><a href="/" class="text-gray-500 hover:text-gray-700 mr-4" aria-label="Back to home"><svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></a> <div class="flex items-center gap-3"><h1 class="text-2xl font-bold text-gray-900"> </h1> <span> </span></div></div> <!></div></div></header> <div class="bg-white border-b"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><nav class="-mb-px flex space-x-8" aria-label="Tabs"><button>Images & Audio</button> <button>Preview Slideshow</button></nav></div></div> <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!></main></div>');function Ye(S,u){ye(u,!0);const[ae,re]=Pe(),oe=()=>Ie(Se,"$page",ae);let t=D(null),N=D(!0),w=D("images");const g=oe().params.id;let se=ee(()=>()=>{if(!e(t)||!e(t).video||!e(t).lastProcessed)return!1;if(e(t).updatedAt&&e(t).lastProcessed){const a=new Date(e(t).updatedAt).getTime();return new Date(e(t).lastProcessed).getTime()>=a}return!0});async function I(){try{const a=await fetch(`${z()}/api/projects/${g}`);a.ok?j(t,await a.json(),!0):(console.error("Project not found:",g),alert("Project not found. Redirecting to home page."),te("/"))}catch(a){console.error("Failed to load project:",a),alert("Failed to load project. Redirecting to home page."),te("/")}finally{j(N,!1)}}function ie(a){switch(a){case"FWI-main":return"FWI Main";case"FWI-emotional":return"FWI Emotional";case"Scavenger-Hunt":return"Scavenger Hunt";default:return"FWI Main"}}function ne(a){switch(a){case"FWI-main":return"bg-blue-100 text-blue-800";case"FWI-emotional":return"bg-purple-100 text-purple-800";case"Scavenger-Hunt":return"bg-green-100 text-green-800";default:return"bg-blue-100 text-blue-800"}}we(()=>{I();const a=window.location.hostname,n=new WebSocket(`ws://${a}:3000`);return n.onmessage=T=>{const h=JSON.parse(T.data);h.projectId===g&&(j(t,{...e(t),...h},!0),h.status==="completed"&&I())},()=>{n.close()}});function O(){I()}function de(){I()}async function le(a="normal"){try{const n=await fetch(`${z()}/api/process/${g}/process`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:a})});if(n.ok){const T=await n.json();j(t,{...e(t),status:"processing"},!0)}}catch(n){console.error("Failed to start processing:",n)}}var R=Y(),ce=Z(R);{var ve=a=>{var n=We();p(a,n)},pe=(a,n)=>{{var T=h=>{var F=Ne(),$=o(F),G=o($),J=o(G),A=o(J),E=v(o(A),2),M=o(E),me=o(M,!0);s(M);var W=v(M,2),ue=o(W,!0);s(W),s(E),s(A);var ge=v(A,2);{var he=d=>{var i=Ve(),f=o(i);{var x=l=>{Te(l,{get project(){return e(t)}})},y=(l,k)=>{{var P=r=>{var b=Ue();H(B=>je(b,"href",`${B??""}/api/process/${g??""}/download`),[z]),p(r,b)},c=r=>{var b=Be();b.__click=[Ce,le];var B=v(o(b));s(b),H(()=>V(B,` ${e(t).video?"Re-render Slideshow":"Generate Slideshow"}`)),p(r,b)};m(l,r=>{e(se)?r(P):r(c,!1)},k)}};m(f,l=>{e(t).status==="processing"?l(x):l(y,!1)})}s(i),p(d,i)};m(ge,d=>{var i;((i=e(t).images)==null?void 0:i.length)>0&&e(t).audio&&d(he)})}s(J),s(G),s($);var U=v($,2),q=o(U),K=o(q),C=o(K);C.__click=[De,w];var Q=v(C,2);Q.__click=[He,w],s(K),s(q),s(U);var X=v(U,2),fe=o(X);{var xe=d=>{var i=ze(),f=o(i),x=v(o(f),2);{var y=r=>{Ae(r,{get projectId(){return g},$$events:{uploaded:O}})},l=r=>{Me(r,{get project(){return e(t)},$$events:{updated:I,"add-more":O}})};m(x,r=>{!e(t).images||e(t).images.length===0?r(y):r(l,!1)})}s(f);var k=v(f,2),P=v(o(k),2);const c=ee(()=>!!e(t).audio);$e(P,{get projectId(){return g},get hasAudio(){return e(c)},get audioFile(){return e(t).audio},$$events:{uploaded:de}}),s(k),s(i),p(d,i)},be=(d,i)=>{{var f=x=>{var y=Y(),l=Z(y);{var k=c=>{Fe(c,{get project(){return e(t)}})},P=c=>{var r=Le();p(c,r)};m(l,c=>{var r;((r=e(t).images)==null?void 0:r.length)>0?c(k):c(P,!1)})}p(x,y)};m(d,x=>{e(w)==="slideshow"&&x(f)},i)}};m(fe,d=>{e(w)==="images"?d(xe):d(be,!1)})}s(X),s(F),H((d,i)=>{V(me,e(t).name),L(W,1,`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${d??""}`),V(ue,i),L(C,1,`py-4 px-1 border-b-2 font-medium text-sm ${e(w)==="images"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),L(Q,1,`py-4 px-1 border-b-2 font-medium text-sm ${e(w)==="slideshow"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`)},[()=>ne(e(t).type),()=>ie(e(t).type)]),p(h,F)};m(a,h=>{e(t)&&h(T)},n)}};m(ce,a=>{e(N)?a(ve):a(pe,!1)})}p(S,R),ke(),re()}_e(["click"]);export{Ye as component};
